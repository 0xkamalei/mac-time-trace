# 未完成功能清单 (Missing Features Checklist)

**文档版本**: 1.0  
**创建日期**: 2025年10月31日  
**最后更新**: 2025年10月31日  
**当前完成度**: ~50%

## 📋 概述

本文档记录了时间追踪应用相对于产品规格文档 (`docs/product/`) 中定义的功能的完成状态。通过对比当前实现与产品文档中的UI/UX规格，识别出需要实现的缺失功能。

## 🎯 完成度总览

| 组件 | 预期功能 | 当前状态 | 完成度 |
|------|----------|----------|--------|
| **核心架构** | 三栏布局，导航系统 | ✅ 已完全实现 | 95% |
| **Activities 视图** | 分组模式，增强展开 | ⚠️ 仅基础版本 | 60% |
| **Stats 视图** | 分析仪表板，图表，指标 | ❌ 未实现 | 0% |
| **Reports 视图** | 可定制表格，导出控制 | ❌ 未实现 | 0% |
| **Timeline 组件** | 交互式时间线控制 | ⚠️ 仅显示功能 | 40% |
| **Time Entries 视图** | 管理界面 | ✅ 已完全实现 | 90% |
| **项目管理** | 层级项目，颜色 | ✅ 已完全实现 | 85% |
| **数据模型** | 综合追踪 | ✅ 已完全实现 | 90% |

**总体完成度**: 约 50%

---

## ❌ 高优先级缺失功能

### 1. Stats 视图 - 完全缺失 ⭐⭐⭐

**参考**: `docs/product/screenshots/02-stats-view.png` (Figure 2)

**缺失组件**:

#### 1.1 统计卡片区域
- [ ] "Total time" 卡片，显示大字体时长
- [ ] "Productivity score" 卡片，显示百分比
- [ ] 卡片样式：`#F5F5F5` 背景，24px 内边距，8px 圆角

#### 1.2 图表区域
- [ ] "Most active hours" - 按小时显示时间分布的柱状图
- [ ] "Most productive hours" - 按小时显示生产力时间的柱状图
- [ ] "Most active weekdays" - 按日显示每日分布的柱状图
- [ ] "Most productive weekdays" - 按日显示生产力天数的柱状图
- [ ] 图表容器：`#F5F5F5` 背景，20px 内边距，~400px 高度

#### 1.3 数据表格区域
- [ ] Applications 列表，显示应用使用时长
- [ ] Projects & Time Entries 列表，显示项目时长
- [ ] 表格样式：31px 行高，轮换背景色

**技术要求**:
- 创建 `StatsView.swift` 文件
- 实现图表组件（可使用 Swift Charts 框架）
- 数据聚合和计算逻辑
- 响应式布局适配

### 2. Reports 视图 - 完全缺失 ⭐⭐⭐

**参考**: `docs/product/screenshots/03-reports-view.png` (Figure 3)

**缺失组件**:

#### 2.1 右侧控制面板 (280px 宽度)
- [ ] 视图模式单选按钮组 (Table/Details)
- [ ] "Include:" 下拉菜单，选择数据类型
- [ ] "Columns:" 复选框组：
  - [ ] ☑ Project
  - [ ] ☑ Title  
  - [ ] ☐ Notes
  - [ ] ☐ Billing Status
  - [ ] ☐ Timespan
- [ ] "Filter:" 下拉按钮
- [ ] "File Format:" 下拉菜单 (Excel/CSV)
- [ ] "Duration Format:" 下拉菜单 (XX:YY:ZZ/Decimal)
- [ ] "Export..." 主要按钮

#### 2.2 主数据表格
- [ ] 可排序的三列表格：
  - Duration (右对齐)
  - Project (项目名称)
  - Title (活动描述)
- [ ] 表头样式：`#F5F5F5` 背景，13px Semibold 字体
- [ ] 行样式：31px 高度，悬停效果

#### 2.3 导出功能
- [ ] Excel 格式导出
- [ ] CSV 格式导出
- [ ] 自定义列选择
- [ ] 时长格式选项

**技术要求**:
- 创建 `ReportsView.swift` 文件
- 实现导出功能（可使用 UniformTypeIdentifiers）
- 表格排序和过滤逻辑
- 文件保存对话框

### 3. Activities 视图分组模式 - 缺失 ⭐⭐

**参考**: `docs/product/screenshots/04-06-activities-*.png` (Figures 4-6)

**缺失组件**:

#### 3.1 分组模式单选按钮
- [ ] 三个单选按钮，位于 Activities 视图右上角
- [ ] 位置：x: 2332-2459, y: 217
- [ ] 模式切换时的平滑过渡动画 (0.2-0.3s)

#### 3.2 三种分组模式
- [ ] **模式 1: 统一视图** (默认)
  - 按项目/类别分组
  - 层级结构，带展开三角形
  - 单一平面列表显示所有活动

- [ ] **模式 2: 分组视图** (替代方案)
  - 按时间段重新组织 (今天/昨天/本周等)
  - 或按应用类别分组
  - 与模式1不同的主要分组标准

- [ ] **模式 3: 替代视图** (第三种方法)
  - 基于时间线、上下文或自定义分组
  - 与模式1和2显著不同的呈现方式
  - 独特的视觉处理和组织逻辑

#### 3.3 模式持久化
- [ ] 选中的分组模式在会话间保持
- [ ] 切换模式时重置展开状态

**技术要求**:
- 修改 `ActivitiesView.swift`
- 实现分组逻辑切换
- 添加单选按钮组件
- 状态持久化

---

## ⚠️ 中优先级缺失功能

### 4. 增强的活动展开行为 ⭐⭐

**参考**: `docs/product/screenshots/07-expanded-app-detail.png` (Figure 7)

**当前状态**: 基础展开功能已实现，但缺少应用特定的展开行为

**缺失功能**:

#### 4.1 应用特定的元数据显示
- [ ] **丰富元数据应用**:
  - 详细时间戳范围: "2025/10/31, 10:26:04 – 10:30:49"
  - 示例：time-tracing, Cherry Studio, 代码编辑器
  
- [ ] **最小元数据应用**:
  - 占位符文本: "(No additional information available)"
  - 示例：Arc, Warp, Timing
  
- [ ] **系统/实用程序应用**:
  - 仅显示应用名称
  - 示例：Universal Control, Finder
  - 大多数情况下无子条目

#### 4.2 展开动画增强
- [ ] 展开三角形即时旋转 (▶ ↔ ▼)
- [ ] 子行滑下淡入效果 (0.15-0.2s)
- [ ] 错开效果：行间5-10ms延迟
- [ ] 缩进：每级~20px

**技术要求**:
- 修改 `HierarchicalActivityRow.swift`
- 实现应用特定的展开逻辑
- 增强动画效果

### 5. Timeline 交互功能 ⭐⭐

**当前状态**: 显示功能已实现，缺少交互功能

**缺失功能**:

#### 5.1 基础交互
- [ ] 点击活动块进行选择/高亮
- [ ] 拖拽调整活动时长
- [ ] 缩放功能 (放大/缩小)
- [ ] 多选活动

#### 5.2 导航控制
- [ ] 时间线导航控制
- [ ] 缩放级别控制
- [ ] 当前时间指示器

**技术要求**:
- 修改 `TimelineView.swift`
- 实现手势识别
- 添加选择管理器

### 6. 表单对话框增强 ⭐

**当前状态**: 基础项目和时间条目创建已实现

**缺失功能**:

#### 6.1 增强的新项目对话框
- [ ] 完整的表单字段集
- [ ] 颜色选择器
- [ ] 描述字段
- [ ] 键盘快捷键

#### 6.2 增强的新时间条目对话框
- [ ] 完整功能集
- [ ] 标签支持
- [ ] 计费状态
- [ ] 验证和错误处理

#### 6.3 启动计时器对话框
- [ ] 3种操作状态
- [ ] 计时器显示
- [ ] 估计时长设置

**技术要求**:
- 增强现有表单视图
- 添加验证逻辑
- 改进用户体验

---

## 🔧 低优先级功能

### 7. 高级动画和过渡 ⭐

**缺失功能**:
- [ ] 视图间切换动画
- [ ] 微交互动画
- [ ] 加载状态动画
- [ ] 悬停效果增强

### 8. 导出功能 ⭐

**缺失功能**:
- [ ] 数据可移植性
- [ ] 多种文件格式支持
- [ ] 自定义导出选项
- [ ] 批量操作

### 9. 性能优化 ⭐

**缺失功能**:
- [ ] 大数据集优化
- [ ] 内存使用优化
- [ ] 响应性改进
- [ ] 后台处理

---

## 📁 文件结构建议

基于缺失功能，建议创建以下文件：

```
time/Views/
├── Stats/
│   ├── StatsView.swift                    # 主统计视图
│   ├── StatCardView.swift                 # 统计卡片组件
│   ├── ChartView.swift                    # 图表组件
│   └── StatsDataProcessor.swift           # 统计数据处理
├── Reports/
│   ├── ReportsView.swift                  # 主报告视图
│   ├── ReportControlPanel.swift           # 右侧控制面板
│   ├── ReportTableView.swift              # 数据表格
│   └── ExportManager.swift                # 导出功能管理
└── Activities/
    ├── ActivityGroupingModes.swift        # 分组模式逻辑
    ├── GroupingModeSelector.swift         # 单选按钮组件
    └── EnhancedExpansionBehavior.swift    # 增强展开行为
```

---

## 🚀 实施路线图

### 阶段 1: 核心分析功能 (2-3周)
1. 实现 Stats 视图基础结构
2. 实现 Reports 视图基础结构
3. 添加基础图表功能

### 阶段 2: 交互增强 (1-2周)
1. 实现 Activities 分组模式
2. 增强活动展开行为
3. 添加 Timeline 交互功能

### 阶段 3: 功能完善 (1周)
1. 完善表单对话框
2. 添加导出功能
3. 性能优化和动画

---

## 📝 测试清单

### Stats 视图测试
- [ ] 统计卡片正确显示数据
- [ ] 图表渲染正确
- [ ] 数据更新时视图刷新
- [ ] 响应式布局工作正常

### Reports 视图测试
- [ ] 控制面板功能正常
- [ ] 表格排序工作
- [ ] 导出功能正常
- [ ] 过滤器正确应用

### Activities 分组模式测试
- [ ] 三种模式切换正常
- [ ] 过渡动画流畅
- [ ] 模式持久化工作
- [ ] 展开状态正确重置

### Timeline 交互测试
- [ ] 点击选择功能
- [ ] 拖拽调整功能
- [ ] 缩放功能
- [ ] 多选功能

---

## 📊 进度跟踪

**创建日期**: 2025年10月31日  
**预计完成**: 2025年12月15日  

| 功能 | 状态 | 开始日期 | 完成日期 | 负责人 |
|------|------|----------|----------|--------|
| Stats 视图 | ❌ 未开始 | - | - | - |
| Reports 视图 | ❌ 未开始 | - | - | - |
| Activities 分组 | ❌ 未开始 | - | - | - |
| 增强展开 | ❌ 未开始 | - | - | - |
| Timeline 交互 | ❌ 未开始 | - | - | - |
| 表单增强 | ❌ 未开始 | - | - | - |

---

## 🔗 相关文档

- **产品规格**: `docs/product/Timing_UI_Spec.md`
- **截图参考**: `docs/product/SCREENSHOTS.md`
- **版本说明**: `docs/product/VERSION_1.2_RELEASE_NOTES.md`
- **项目完成总结**: `docs/product/PROJECT_COMPLETION_SUMMARY.md`

---

**文档维护**: 请在实现功能时更新此文档的进度状态。